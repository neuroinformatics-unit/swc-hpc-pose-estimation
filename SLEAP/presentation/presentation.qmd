---
title: Pose estimation with SLEAP
subtitle: Applied HPC use example
author: Niko Sirmpilatze
format:
    revealjs:
        theme: [default, niu-light.scss]
        logo: img/logo_niu_light.png
        footer: "Introduction to HPC with Linux | 2023-05-15"
        slide-number: c
        menu:
            numbers: true
        chalkboard: true
        scrollable: true
        preview-links: false
        view-distance: 10
        mobile-view-distance: 10
        auto-animate: true
        auto-play-media: true
        code-overflow: wrap
        highlight-style: atom-one
---

## Outline

::: {.incremental}
- Pose estimation primer
- SLEAP pipeline showcase
  - Running a single training job on HPC
  - Batching multiple jobs
:::

## Tracking animals in videos {.smaller}

:::: {.columns}

::: {.column width="60%"}
![From: *Quantifying behavior to understand the brain, Nat Neuro 2020*](img/tracking_types.png){fig-align=center height=500}
:::

::::

## Pose estimation {.smaller}

![From: *Quantifying behavior to understand the brain, Nat Neuro 2020*](img/pose_estimation_2D.png){.r-stretch fig-align=left}

## Top-down vs bottom-up {.smaller}

![From: *Quantifying behavior to understand the brain, Nat Neuro 2020*](img/pose_estimation_topdown_vs_bottomup.png){fig-align=left height=500}

## Existing tools

:::: {.columns}

::: {.column width="35%"}
- [DeepLabCut](http://www.mackenziemathislab.org/deeplabcut)
- [SLEAP](https://sleap.ai/)
- [Many others](../../pose_estimation_tools.md):
  - OpenPose
  - DeepPoseKit
  - Anipose
  - Freipose
  - ...
:::

::: {.column width="65%"}
![](img/sleap_movie.gif)
:::

::::

## SLEAP workflow


![](diagrams/pose-estimation.svg){fig-align=center height=500}

::: aside
training and inference are GPU-intensive
:::

## Where we can help {.smaller}

#### Issues:

* Training and inference steps are compute- and time-intensive
* Most researchers do not use HPC, because its hard to set up

::: {.fragment}
#### Goals:

* Keep `DeepLabCut` HPC module up-to-date and functioning
* Consider adding a `SLEAP` HPC module
* Provide `How To` documentation ([already working on this](https://hackmd.io/@i1EOuEktR1OzOa4jaySmKw/H1-UGHBDi))
* Write and share convenience scripts, where necessary
:::

## `Deeplabcut` output

| bodyparts	| head	| head	| head |
| ---- | ---- | ---- | ---- |
| **coords** | **x** | **y** | **likelihood** |
| 0 | 891.6274	| 329.8043 | 0.9814 |
| 1 | 898.9066	| 336.1953 | 0.9948 |
| 2 | 908.2570	| 339.9593 | 0.9973 |
| 3 | 918.3987	| 343.0952 | 0.9920 |
| 4 | 929.2968	| 348.0225 | 0.9912 |
| 5 | 940.5545	| 351.2606 | 0.9757 |

## Acknowledgements {.smaller}

Thanks to SWC researchers for sharing their time, expertise and data:

* Sepiedeh Keshavarzi
* Nicole Vissers
* Loukia Katsouri
* Jai Bhagat
* Dario Campagner
* Peter Vincent
* Sanna Titus
